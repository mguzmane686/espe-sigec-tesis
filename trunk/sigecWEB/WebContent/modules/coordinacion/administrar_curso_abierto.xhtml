<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
    xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:p="http://primefaces.org/ui"
	xmlns:sigecComp="http://java.sun.com/jsf/composite/components">
    
    	<h:outputStylesheet library="css" name="textos.css"/>    
    	<h:outputStylesheet library="css" name="bordes.css"/>
    	<h:outputStylesheet library="css" name="botones.css"/>
    		
        <h:form id="frmCurso">
        	
        	<rich:panel header="Administrar curso">
        		<h:panelGroup layout="block" styleClass="roundCorner" id="pnlCurso">
	        		<h:panelGrid columns="4">
	        			<h:panelGrid columns="1" style="padding-left:10px; text-align:center;" rendered="#{administrarCursoController.editMode}">
	        				<a4j:commandButton value="#{msg['guardar']}" render="pnlCurso, pnlLanCur" actionListener="#{administrarCursoController.btnSave}" 
	        					 image="/resources/images/save.png"/>
	        				<h:outputLabel value="#{msg['guardar']}" />
	        			</h:panelGrid>
	        			
	        			<h:panelGrid columns="1" style="padding-left:10px; text-align:center;" rendered="#{!administrarCursoController.editMode}">
	        				<a4j:commandButton value="#{msg['editar']}" render="pnlCurso, pnlLanCur" actionListener="#{administrarCursoController.btnEdit}" execute="@this" 
	        					 image="/resources/images/edit.png"/>
	        				<h:outputLabel value="#{msg['editar']}" />
	        			</h:panelGrid>
	        			
	        			<h:panelGrid columns="1" style="padding-left:10px; text-align:center;" rendered="#{administrarCursoController.editMode}">
	        				<a4j:commandButton value="#{msg['cancelar']}" render="pnlCurso, pnlLanCur" actionListener="#{administrarCursoController.btnCancelEdit}" execute="@this" 
	        					 image="/resources/images/cancel.png"/>
	        				<h:outputLabel value="#{msg['cancelar']}" />
	        			</h:panelGrid>
	        			
	        			<h:panelGrid columns="1" style="padding-left:10px; text-align:center;" rendered="#{!administrarCursoController.editMode}">
	        				<a4j:commandButton value="Presupuesto" execute="@this" actionListener="#{administrarCursoController.btnPresupuestoCurso}" 
	        					image="/resources/images/budget.png"/>
	        				<h:outputLabel value="Presupuesto" />
	        			</h:panelGrid>
	        			
	        			<h:panelGrid columns="1" style="padding-left:10px; text-align:center;" rendered="#{!administrarCursoController.editMode}">
	        				<a4j:commandButton value="Inscritos" execute="@this" oncomplete="#{rich:component('rppInscritos')}.show();" 
	        					actionListener="#{administrarCursoController.btnInscritos}" render="rppInscritos"
	        					 image="/resources/images/user_group_colored.png"/>
	        				<h:outputLabel value="Inscritos" />
	        			</h:panelGrid>
	        			
	        			<h:panelGrid columns="1" style="padding-left:10px; text-align:center;" rendered="#{!administrarCursoController.editMode}">
	        				<a4j:commandButton value="Atras" render="pnlCurso" immediate="true" 
	        					actionListener="#{administrarCursoController.btnReturnCursosAbiertos}" image="/resources/images/go-back.png"/>
	        				<h:outputLabel value="Atras" />
	        			</h:panelGrid>
	        		</h:panelGrid>
        		</h:panelGroup>
        	</rich:panel>
        	

        	<rich:popupPanel id="rppInscritos" domElementAttachment="form" header="Inscitos al curso" autosized="true">
	        	<f:facet name="controls">
					<h:outputLink value="#" onclick="#{rich:component('rppInscritos')}.hide(); return false;">
		                <h:graphicImage library="org.richfaces" name="close_act.gif" style="border:0px;"/>
		            </h:outputLink>
				</f:facet>
				
				<h:commandLink>
					<h:panelGrid columns="2">
						<h:graphicImage library="images/button" name="ms-excel.png" style="width: 14px; height:14px;"/>
						<h:outputText value="Reporte inscritos" />
					</h:panelGrid>
        			<p:dataExporter target="tblInscritos" type="xls" fileName="Reporte_alumnos_inscritos_#{administrarCursoController.cursoPeriodo.curso.nombreCurso}" ></p:dataExporter>
        		</h:commandLink>
        		
				<p:dataTable id="tblInscritos" value="#{administrarCursoController.lstInscritos}" var="inscritos" paginatorAlwaysVisible="false"
					emptyMessage="No existen inscritos" paginator="true" paginatorPosition="top" rows="10" rowIndexVar="numRow">
					<p:column>
						<f:facet name="header">
							<h:outputText value="#" />
						</f:facet>
						<h:outputText value="#{numRow + 1}" />
					</p:column>
					
					<p:column headerText="#{msg.cedula} estudiante">
						<f:facet name="header">
							<h:outputText value="#{msg.cedula}" />
						</f:facet>
						<h:outputText value="#{inscritos.estudiante.persona.cedula}" />
					</p:column>
					
					<p:column headerText="Nombre">
						<f:facet name="header">
							<h:outputText value="Nombre" />
						</f:facet>
						<h:outputText value="#{inscritos.estudiante.persona.nombreCompleto}" />
					</p:column>
					
				</p:dataTable>
        	</rich:popupPanel>
        	
        	<rich:panel header="Administrar curso" id="pnlLanCur">
        		<h:panelGroup rendered="#{(administrarCursoController.cursoPeriodo.historicoCursoEstadoCollection.etapaAsignacionProfesor == '1') and 
        		 (administrarCursoController.cursoPeriodo.historicoCursoEstadoCollection.etapaEjecutado == '0') and (administrarCursoController.cursoPeriodo.idProfesor == null)}">
        			<fieldset style="border-color:red">
		        		<legend>
		        			<h:outputLabel value="Alerta!!!" styleClass="titulo" style="color:#1394EB;"/>
		        			
		        		</legend>
		        		
		        		<h:panelGroup style="width:100%; background-color:#CEDE64;" layout="block">
			        		<h:outputLabel value="#{msg.curso_completo_inscritos}" styleClass="titulo" style="color:#3D413F"/>
		        		</h:panelGroup>
		        		
		        		
	        		</fieldset>
        		</h:panelGroup>
	        	<rich:collapsiblePanel header="#{msg.etiqueta_fecha_del_curso}"  headerClass="headerDivCollap" styleClass="mainDivCollap" 
					leftCollapsedIcon="triangleDown" leftExpandedIcon="triangleUp" switchType="client">
	        		
	        		<h:panelGroup rendered="#{administrarCursoController.editMode}">
		        			<h:panelGrid columns="2">
			        			<h:outputLabel value="Profesor :" style="display:block; width:120px;"/>
			        			<rich:select value="#{administrarCursoController.cursoPeriodo.idProfesor}">
			        				<f:selectItems value="#{administrarCursoController.itemsProfesor}" var="prof"
			        					itemLabel="#{prof.profesor.persona.primerNombre}" itemValue="#{prof.profesor.idProfesor}"/>
			        					
			        			</rich:select>
		        			</h:panelGrid>
		        		</h:panelGroup>
		        		
	        		<h:panelGrid columns="2"  columnClasses="espacioDetalle">
	        			<h:outputLabel value="#{msg.etiqueta_usuarios_inscritos} :" style="font-weight:bold;"/>
	        			<h:outputText value="#{administrarCursoController.numeroAlumnosInscritos}" style="font-weight:bold;"/>
	        		
	        			<h:outputLabel value="#{msg.fecha_inicio}: " />
	        			<rich:calendar rendered="false" value="#{administrarCursoController.cursoPeriodo.periodoAcademico.fechaInicio}" datePattern="#{msg['dd_MMM_yyyy']}" disabled="true"/>
	        			
	        			<h:outputText value="#{administrarCursoController.cursoPeriodo.periodoAcademico.fechaInicio}">
        					<f:convertDateTime pattern="#{msg['dd_MMM_yyyy']}"/>
        				</h:outputText>
			        				
	        			<h:outputLabel value="#{msg.fecha_finalizacion}:" />
	        			<rich:calendar rendered="false" value="#{administrarCursoController.cursoPeriodo.periodoAcademico.fechaFin}" datePattern="#{msg['dd_MMM_yyyy']}" disabled="true"/>
	        			<h:outputText value="#{administrarCursoController.cursoPeriodo.periodoAcademico.fechaFin}">
        					<f:convertDateTime pattern="#{msg['dd_MMM_yyyy']}"/>
        				</h:outputText>
	        		</h:panelGrid>
	        	</rich:collapsiblePanel>
        	
        		<rich:collapsiblePanel header="#{msg['datos_especificos']}"  headerClass="headerDivCollap" styleClass="mainDivCollap" 
					leftCollapsedIcon="triangleDown" leftExpandedIcon="triangleUp" switchType="client">
	        	
        			<h:panelGrid columns="2" columnClasses="espacioDetalle">
        				<h:outputLabel value="Curso :"/>
        				<h:outputText value="#{administrarCursoController.cursoPeriodo.curso.nombreCurso}" />
        				
        				
        				
        				<h:outputLabel value="#{msg['minimo_estudiantes']} :" />
        				<rich:inputNumberSpinner rendered="#{administrarCursoController.editMode}" value="#{administrarCursoController.cursoPeriodo.minimoEstudiantes}"/>
        				<h:outputText value="#{administrarCursoController.cursoPeriodo.minimoEstudiantes}" rendered="#{!administrarCursoController.editMode}"/>
        				
        				<h:outputLabel value="#{msg['maximo_estudiantes']} :" />
        				<rich:inputNumberSpinner rendered="#{administrarCursoController.editMode}" value="#{administrarCursoController.cursoPeriodo.maximoEstudiantes}"/>
        				<h:outputText value="#{administrarCursoController.cursoPeriodo.maximoEstudiantes}" rendered="#{!administrarCursoController.editMode}"/>
        				
        				
        				<h:outputLabel value="#{msg['tipo_curso']} :"/>
        				<h:selectOneRadio value="#{administrarCursoController.cursoPeriodo.tipoCurso}" rendered="#{administrarCursoController.editMode}">
        					<f:selectItem itemLabel="Empresarial" itemValue="CORP"/>
        					<f:selectItem itemLabel="Abierto" itemValue="IND"/>
        				</h:selectOneRadio>
        				<h:outputText value="#{(administrarCursoController.cursoPeriodo.tipoCurso =='CORP'?'Empresarial':'Abierto')}" rendered="#{!administrarCursoController.editMode}"/>
        				
        				<h:outputLabel value="Lugar :" />
        				<h:inputText rendered="#{administrarCursoController.editMode}" value="#{administrarCursoController.cursoPeriodo.lugarCapacitacion}" />
        				<h:outputText value="#{administrarCursoController.cursoPeriodo.lugarCapacitacion}" rendered="#{!administrarCursoController.editMode}"/>
        				
        				<h:outputLabel value="Estado del curso :" />
						<h:outputText value="#{administrarCursoController.cursoPeriodo.estadoProceso}" rendered="#{!administrarCursoController.editMode}"/>
						
						<h:panelGrid columns="3">
							<h:selectOneRadio value="#{administrarCursoController.cursoPeriodo.historicoCursoEstadoCollection.etapaLanzado}" rendered="#{administrarCursoController.editMode}">
	        					<f:selectItem itemLabel="Abierto" itemValue="1"/>
	        				</h:selectOneRadio>
	        				
	        				<h:selectOneRadio value="#{administrarCursoController.cursoPeriodo.historicoCursoEstadoCollection.etapaEjecutado}" rendered="#{administrarCursoController.editMode}">
	        					<f:selectItem itemLabel="Ejecucion" itemValue="1"/>
	        				</h:selectOneRadio>
	        				
	        				<h:selectOneRadio value="#{administrarCursoController.cursoPeriodo.historicoCursoEstadoCollection.etapaFinalizado}" rendered="#{administrarCursoController.editMode}">
	        					<f:selectItem itemLabel="Finalizado" itemValue="1"/>
	        				</h:selectOneRadio>
						</h:panelGrid>
				
        			</h:panelGrid>
        		</rich:collapsiblePanel>	
        	</rich:panel>
        </h:form>
</ui:composition>
