<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
    xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:p="http://primefaces.org/ui"
	xmlns:sigecComp="http://java.sun.com/jsf/composite/components">
    
    	<h:outputStylesheet library="css" name="textos.css"/>    
    	<h:outputStylesheet library="css" name="bordes.css"/>
    	<h:outputStylesheet library="css" name="botones.css"/>
    	
        <h:form id="frmInscritoCurso">
        	
        	<rich:panel header="Inscritos al curso" id="pnlLanCur">
        		
	        	<rich:collapsiblePanel header="Filtro curso"  headerClass="headerDivCollap" styleClass="mainDivCollap" 
					leftCollapsedIcon="triangleDown" leftExpandedIcon="triangleUp" switchType="client">
	        		<rich:select value="#{inscritosCursoController.programa.idPrograma}" valueChangeListener="#{inscritosCursoController.rsCargarCursosPrograma}"> 
	        			<f:selectItems value="#{inscritosCursoController.lstProgramas}" var="itemPrograma" itemLabel="#{itemPrograma.nombre}" itemValue="#{itemPrograma.idPrograma}"/>
	        			<a4j:ajax event="selectitem" execute="@this" render="pgPrgCursos"/>
	        		</rich:select>
	        		
	        		<h:panelGrid id="pgPrgCursos" columns="1" style="margins:auto; width:100%">
		        		<rich:dataScroller id="rdsPrgCursos" for="tblPrgCursos" renderIfSinglePage="false" style="margin:auto;text-align:center; width:100%;" boundaryControls="hide"/>
		        		<rich:dataTable id="tblPrgCursos" value="#{inscritosCursoController.lstProgramaCursos}" var="itemsProgramaCurso"
		        			noDataLabel="No existen cursos asignados a el programa" rows="2" style="width:100%;">
		        			<rich:column>
		        				<f:facet name="header">
		        					Nombre
		        				</f:facet>
		        				<a4j:commandLink value="#{itemsProgramaCurso.cursoPeriodo.curso.nombreCurso}" execute="@this" 
		        					action="#{inscritosCursoController.btnCargarInscritos(itemsProgramaCurso)}" render="tblInscritos"/>
		        			</rich:column>
		        		</rich:dataTable>
		        		
		        		
		        		<p:dataTable id="tblInscritos" value="#{inscritosCursoController.lstInscritos}" var="inscritos" paginatorAlwaysVisible="false"
							emptyMessage="No existen inscritos" paginator="true" paginatorPosition="top" rows="10" rowIndexVar="numRow">
							<f:facet name="header">
								Estudiantes inscritos
							</f:facet>
							<p:column>
								<f:facet name="header">
									<h:outputText value="#" />
								</f:facet>
								<h:outputText value="#{numRow + 1}" />
							</p:column>
							
							<p:column headerText="#{msg.cedula} estudiante">
								<f:facet name="header">
									<h:outputText value="#{msg.cedula}" />
								</f:facet>
								<h:outputText value="#{inscritos.estudiante.persona.cedula}" />
							</p:column>
							
							<p:column headerText="Nombre">
								<f:facet name="header">
									<h:outputText value="Nombre" />
								</f:facet>
								<h:outputText value="#{inscritos.estudiante.persona.nombreCompleto}" />
							</p:column>
							
							<p:column headerText="Estado de pago">
								<f:facet name="header">
									<h:outputText value="Estado de pago" />
								</f:facet>
								
								<a4j:commandLink value="#{inscritos.estadoPago}" execute="@this" action="#{inscritosCursoController.btnCambiarEstadoPago(inscritos)}" render="pgEstudiantePago" 
									oncomplete="#{rich:component('rppInscritos')}.show();" />
							</p:column>
							
							<p:column headerText="Cupo">
								<f:facet name="header">
									<h:outputText value="Cupo" />
								</f:facet>
								
								<a4j:commandLink value="#{inscritos.estadoCupo}" execute="@this" action="#{inscritosCursoController.btnCambiarEstadoPago(inscritos)}" render="pgEstudiantePago" 
									oncomplete="#{rich:component('rppInscritos')}.show();" />
							</p:column>
							
						</p:dataTable>
						
						<rich:popupPanel id="rppInscritos" domElementAttachment="form" header="Inscitos al curso" autosized="true">
					        	<f:facet name="controls">
									<h:outputLink value="#" onclick="#{rich:component('rppInscritos')}.hide(); return false;">
						                <h:graphicImage library="org.richfaces" name="close_act.gif" style="border:0px;"/>
						            </h:outputLink>
								</f:facet>
							<rich:collapsiblePanel header="Filtro curso"  headerClass="headerDivCollap" styleClass="mainDivCollap" 
								leftCollapsedIcon="triangleDown" leftExpandedIcon="triangleUp" switchType="client">
								<h:panelGrid columns="2" id="pgEstudiantePago">
									<h:outputText value="Estudiante" />
									<h:outputText value="#{inscritosCursoController.estudianteInscrito.estudiante.persona.nombreCompleto}" />
									
									<h:outputText value="Estado cupo" />
									<rich:select value="#{inscritosCursoController.estudianteInscrito.estadoCupo}">
										<f:selectItem itemValue="CUPO-VIGENTE" itemLabel="CUPO-VIGENTE" />
										<f:selectItem itemValue="CUPO-ANULADO" itemLabel="CUPO-ANULADO" />
									</rich:select>
									
									<h:outputText value="Estado pago" />
									<rich:select value="#{inscritosCursoController.estudianteInscrito.estadoPago}">
										<f:selectItem itemValue="DEBE" itemLabel="DEBE" />
										<f:selectItem itemValue="PAGADO" itemLabel="PAGADO"/>
										<f:selectItem itemValue="DEVOLUCION" itemLabel="DEVOLUCION" />
									</rich:select>
									
									
								</h:panelGrid>
								
								<h:panelGrid style="margin:auto; text-align:center;" columns="2">
									<a4j:commandButton value="Actualizar datos" execute="pgEstudiantePago" render="tblInscritos"
										action="#{inscritosCursoController.btnActualizarEstadoPago}"
										oncomplete="#{rich:component('rppInscritos')}.hide();"/>
										
									<a4j:commandButton value="Cancelar" onclick="#{rich:component('rppInscritos')}.hide(); return false;"/>
								</h:panelGrid>
							</rich:collapsiblePanel>
							
						</rich:popupPanel>
	        		</h:panelGrid>
        		</rich:collapsiblePanel>	
        	</rich:panel>
        </h:form>
</ui:composition>
