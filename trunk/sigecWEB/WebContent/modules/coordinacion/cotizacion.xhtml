<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets" 
	xmlns:h="http://java.sun.com/jsf/html" 
	xmlns:f="http://java.sun.com/jsf/core" 
	xmlns:a4j="http://richfaces.org/a4j" 
	xmlns:rich="http://richfaces.org/rich" 
	xmlns:sigecComp="http://java.sun.com/jsf/composite/components">

	<h:outputStylesheet library="css" name="textos.css"></h:outputStylesheet>
	<h:outputStylesheet library="css" name="bordes.css"></h:outputStylesheet>
	<h:outputScript library="org.richfaces.staticResource" name="jquery-alternative-version.js"></h:outputScript>
	
	
	<h:outputScript library="js" name="jquery.effects.core.js" />
	<h:outputScript library="js" name="jquery.effects.blind.js" />
    <h:outputStylesheet library="css" name="componentsCss.css" />
    <h:outputScript  library="js" name="componentsJs.js" />
        
	
	<h:outputStylesheet>
		.alinearDerecha{
			text-align:right;
		}
		.subirTabla{
			vertical-align:top;
		}
		.espacioCustom{
			width:160px;
			font-weight:bold;
		}
	</h:outputStylesheet>
	
	<h:form id="frmCotizacion">
		<rich:panel header="Presupuestos" styleClass="titulo">
			<h:panelGroup layout="block" styleClass="roundCorner">
				<h:panelGrid columns="2" id="pgBotones">
					<h:panelGrid columns="1" style="padding-left:10px; text-align:center;" rendered="#{!presupuestoController.editMode}" >
						<a4j:commandButton value="Guardar" image="/resources/images/save.png" execute="@this txtPorUtiEspe txtPorMatOfi tblDetalles" 
							actionListener="#{presupuestoController.btnSavePresupuesto}" render="@form"/>
						<h:outputLabel value="Guardar" />
					</h:panelGrid>
					
					<h:panelGrid columns="1" style="padding-left:10px; text-align:center;" rendered="#{presupuestoController.editMode}" >
						<a4j:commandButton value="#{msg['editar']}" action="#{presupuestoController.btnEditPresupuesto}" execute="@this" render="frmCotizacion"
	       					 image="/resources/images/edit.png"/>
	       				<h:outputLabel value="#{msg['editar']}" />
       				</h:panelGrid>
	       			
	       			<h:panelGrid columns="1" style="padding-left:10px; text-align:center;" rendered="#{!presupuestoController.editMode}">
	       				<a4j:commandButton value="#{msg['cancelar']}" render="frmCotizacion" actionListener="#{presupuestoController.btnCancelEditPresupuesto}" execute="@this" 
	       					 image="/resources/images/cancel.png"/>
	       				<h:outputLabel value="#{msg['cancelar']}" />
	       			</h:panelGrid>
	       			
					<h:panelGrid columns="1" style="padding-left:10px; text-align:center;" rendered="#{presupuestoController.editMode}">
						<a4j:commandButton value="Atras" immediate="true" actionListener="#{presupuestoController.btnAtras}" image="/resources/images/go-back.png" />
						<h:outputLabel value="Atras" />
					</h:panelGrid>
				</h:panelGrid>
			</h:panelGroup>
		</rich:panel>

		<rich:panel header="#{msg.datos_curso}" >
			<h:panelGrid columns="2" columnClasses="espacioCustom," frame="box" style="width:100%;" >
				<h:outputLabel value="#{msg.etiqueta_especialidad} :" />
				<h:outputText value="#{presupuestoController.cursoPeriodo.curso.especialidad.nombre}" />
				
				<h:outputLabel value="Nombre del curso :" />
				<h:outputText value="#{presupuestoController.cursoPeriodo.curso.nombreCurso}" />
				
				<h:outputLabel value="Fecha inicio:" />
				<h:outputText value="#{presupuestoController.cursoPeriodo.periodoAcademico.fechaInicio}">
					<f:convertDateTime pattern="#{msg['dd_MMM_yyyy']}" />
				</h:outputText>

				<h:outputLabel value="Fecha fin:" />
				<h:outputText value="#{presupuestoController.cursoPeriodo.periodoAcademico.fechaFin}">
					<f:convertDateTime pattern="#{msg['dd_MMM_yyyy']}" />
				</h:outputText>

				<h:outputLabel value="#{msg['minimo_estudiantes']} :" />
				<h:outputText value="#{presupuestoController.cursoPeriodo.minimoEstudiantes}" />

				<h:outputLabel value="#{msg['maximo_estudiantes']} :" />
				<h:outputText value="#{presupuestoController.cursoPeriodo.maximoEstudiantes}" />
				
				<h:outputLabel value="#{msg['tipo_curso']} :" />
				<h:selectOneRadio value="#{presupuestoController.cursoPeriodo.tipoCurso}" rendered="#{!presupuestoController.editMode}">
					<f:selectItem itemLabel="Empresarial" itemValue="CORP" />
					<f:selectItem itemLabel="Individual" itemValue="IND" />
				</h:selectOneRadio>
				<h:outputText value="#{(presupuestoController.cursoPeriodo.tipoCurso == 'CORP' ?'Empresarial':'Individual')}" rendered="#{presupuestoController.editMode}"/>
				
				<h:outputLabel value="Lugar a dictarse :" />
				<h:outputText value="#{presupuestoController.cursoPeriodo.lugarCapacitacion}" />
				
				<h:outputLabel value="Estado del curso :" />
				<h:outputText value="#{presupuestoController.cursoPeriodo.estadoProceso}" />
			</h:panelGrid>
		</rich:panel>
		
		<rich:panel header="Datos Presupuesto" id="datosPresu">
			
			<rich:collapsiblePanel header="#{msg['presupuesto_asignacion']}"  headerClass="headerDivCollap" styleClass="mainDivCollap" 
					leftCollapsedIcon="triangleDown" leftExpandedIcon="triangleUp" switchType="client">
			
				<h:panelGrid columns="2">
					<h:outputLabel value="Presupuesto asignado : " />
					<h:outputText value="#{presupuestoController.presupuestoCurso.dineroAsignado} $"/>
					
					<h:outputLabel value="Porcentege suministros y materiales :" />
					<h:inputText id="txtPorMatOfi" value="#{presupuestoController.presupuestoCurso.porcentageMatOfi}" rendered="#{!presupuestoController.editMode}" />
					<h:outputText value="#{presupuestoController.presupuestoCurso.porcentageMatOfi}" rendered="#{presupuestoController.editMode}" />
					
					<h:outputLabel value="Porcentege utilidad Espe:" />
					<h:inputText id="txtPorUtiEspe" value="#{presupuestoController.presupuestoCurso.porcentageUtiEspe}" rendered="#{!presupuestoController.editMode}" />
					<h:outputText value="#{presupuestoController.presupuestoCurso.porcentageUtiEspe} " rendered="#{presupuestoController.editMode}" />
				</h:panelGrid>
				
			
			</rich:collapsiblePanel>
		</rich:panel>
		
		<rich:panel header="Detalle presupuesto">
			
			<rich:collapsiblePanel header="Costos y gastos"  headerClass="headerDivCollap" styleClass="mainDivCollap" 
					leftCollapsedIcon="triangleDown" leftExpandedIcon="triangleUp" switchType="client">	

				<rich:dataTable id="tblDetalles" value="#{presupuestoController.lstDetallePresupuestoCursos}" var="detalle" iterationStatusVar="numRow" style="width:100%">
					<rich:column rendered="false">
						<f:facet name="header">
							<h:outputLabel value="Codigo" />
						</f:facet>
						<h:outputText value="#{detalle.codElemento}" />
					</rich:column>
					
					<rich:column>
						<f:facet name="header">
							<h:outputLabel value="N#" />
						</f:facet>
						<h:panelGroup layout="block" style="text-align:center;">
							<h:outputText value="#{numRow.index+1}" />
						</h:panelGroup>
					</rich:column>
					
					<rich:column>
						<f:facet name="header">
							<h:outputLabel value="#{msg.descripcion}" />
						</f:facet>
						<h:outputText value="#{detalle.detalle}" />
					</rich:column>
					
					<rich:column>
						<f:facet name="header">
							<h:outputLabel value="Unidad" />
						</f:facet>
						<h:panelGroup layout="block" style="text-align:center;">
							<h:selectOneRadio value="#{detalle.unidad}" style="width:100%" rendered="#{!presupuestoController.editMode}">
								<f:selectItem itemLabel="Horas" itemValue="HORA"/>
								<f:selectItem itemLabel="Total" itemValue="TOTAL"/>
								<f:selectItem itemLabel="Unidades" itemValue="UNIDAD"/>
								<f:selectItem itemLabel="Participantes" itemValue="PARTICIPANTE"/>
							</h:selectOneRadio>
							
							<h:outputText value="#{detalle.unidad}" rendered="#{presupuestoController.editMode}"/>
						</h:panelGroup>
					</rich:column>
					
					<rich:column>
						<f:facet name="header">
							<h:outputLabel value="Cantidad" />
						</f:facet>
						<h:panelGroup layout="block" style="text-align:center;">
							<h:inputText value="#{detalle.cantidad}" rendered="#{!presupuestoController.editMode}" style="text-align:right" size="10"/>
							<h:outputText value="#{detalle.cantidad}" rendered="#{presupuestoController.editMode}"/>
						</h:panelGroup>
					</rich:column>
					
					<rich:column>
						<f:facet name="header">
							<h:outputLabel value="Costo unitario USD." />
						</f:facet>
						<h:panelGroup layout="block" style="text-align:center;">
							<h:inputText value="#{detalle.costoUnitario}" rendered="#{!presupuestoController.editMode}" style="text-align:right" size="10"/>
							<h:outputText value="#{detalle.costoUnitario}" rendered="#{presupuestoController.editMode}" style="text-align:right" converter="org.espe.sigec.numberConverter"/>
						</h:panelGroup>
					</rich:column>
					
					<rich:column style="text-align:right;">
						<f:facet name="header">
							<h:outputLabel value="Costo total USD." />
						</f:facet>
						<h:outputText value="#{detalle.costoTotalUSD} $"/>
					</rich:column>
					
					
					<rich:column style="text-align:right;" rendered="#{!presupuestoController.editMode}">
						<f:facet name="header">
							<h:outputLabel value="Cuenta" />
						</f:facet>
						<h:selectOneMenu  value="#{detalle.idCuenta}" selectFirst="true">
							<f:selectItems itemLabel="#{cuentasPresupuesto.preDetDescripcion}" itemValue="#{cuentasPresupuesto.presupuestoDetallePK.idCuenta}" var="cuentasPresupuesto" value="#{detalle.lstCuentasPresupuesto}"></f:selectItems>
						</h:selectOneMenu>
					</rich:column>
					
					<f:facet name="footer">
			            <rich:columnGroup>
			                <rich:column colspan="5" style="text-align:right" styleClass="rf-dt-shdr-c">
			                	<h:outputLabel value="Total" /> 
			                </rich:column>
			                
			                <rich:column style="text-align:right">
			                    <h:outputText id="txtTotal" value="#{presupuestoController.totalLista}" converter="org.espe.sigec.numberConverter"/>
			                </rich:column>
			                <rich:column styleClass="rf-dt-shdr-c" rendered="#{!presupuestoController.editMode}"/>
			            </rich:columnGroup>
			        </f:facet>
				</rich:dataTable>
			</rich:collapsiblePanel>
			
			<rich:collapsiblePanel header="Detalle"  headerClass="headerDivCollap" styleClass="mainDivCollap" 
					leftCollapsedIcon="triangleDown" leftExpandedIcon="triangleUp" switchType="client">
			
				<h:panelGroup>
					<h:panelGrid columns="1" style="width:100%" bgcolor="#DFECFC"  frame="lhs" columnClasses="subirTabla">
				
						<h:panelGrid columns="2" style="width:100%;" bgcolor="#DFECFC"  frame="box" columnClasses="label-bold, alinearDerecha">
							<h:outputLabel value="Suministros y materiales oficina" />
							<h:outputText value="#{presupuestoController.informePresupuesto.resumenCostosCurso.suministrosMatOfi}" 
								converter="org.espe.sigec.numberConverter"/>
							
							<h:outputLabel value="Costo total" />
							<h:outputText value="#{presupuestoController.informePresupuesto.resumenCostosCurso.costoTotal}" 
								converter="org.espe.sigec.numberConverter"/>
							
							<h:outputLabel value="PRECIO POR PARTICIPANTE" />
							<h:outputText value="#{presupuestoController.informePresupuesto.resumenCostosCurso.precioParicipante}" 
								converter="org.espe.sigec.numberConverter"/>
							
							<h:outputLabel value="UTILIDAD ESPE" />
							<h:outputText value="#{presupuestoController.informePresupuesto.resumenCostosCurso.utilidadEspe}" 
								converter="org.espe.sigec.numberConverter"/>
							
							<h:outputLabel value="PRECIO POR PARTICIPANTE + UTILIDAD" />
							<h:outputText value="#{presupuestoController.informePresupuesto.resumenCostosCurso.precioParicipanteFinal}" 
								converter="org.espe.sigec.numberConverter"/>
							
							<h:outputLabel value="UTILIDAD" />
							<h:outputText value="#{presupuestoController.informePresupuesto.resumenCostosCurso.utilidad}" converter="org.espe.sigec.numberConverter"/>
							
							<h:outputLabel value="MARGEN DE UTILIDAD" />
							<h:outputText value="#{presupuestoController.informePresupuesto.resumenCostosCurso.margenUtilidad}" converter="org.espe.sigec.percentageConverter"/>
							
						</h:panelGrid>
						
						<h:panelGrid columns="2" style="width:100%;" bgcolor="#DFECFC" frame="box" columnClasses="subirTabla, subirTabla">
							<h:panelGrid columns="2" style="width:100%;" frame="box" columnClasses="label-bold, alinearDerecha">
								<h:outputLabel value="COSTOS FIJOS" />
								<h:outputText value="#{presupuestoController.informePresupuesto.puntoEquilibrio.costoFijo}" converter="org.espe.sigec.numberConverter"/>
								
								<h:outputLabel value="COSTOS VARIABLES" />
								<h:outputText value="#{presupuestoController.informePresupuesto.puntoEquilibrio.costoVariable}" converter="org.espe.sigec.numberConverter"/>
								
								<h:outputLabel value="COSTO VARI. UNITARIO" />
								<h:outputText value="#{presupuestoController.informePresupuesto.puntoEquilibrio.costoVariableUnitario}" converter="org.espe.sigec.numberConverter"/>
								
								<h:outputLabel value="PRECIO" />
								<h:outputText value="#{presupuestoController.informePresupuesto.puntoEquilibrio.precio}" converter="org.espe.sigec.numberConverter"/>
								
								<h:outputLabel value="PARTICIPANTES" />
								<h:outputText value="#{presupuestoController.cursoPeriodo.maximoEstudiantes}" />
								
								<h:outputLabel value="P. E" />
								<h:outputText value="#{presupuestoController.informePresupuesto.puntoEquilibrio.puntoEquilibrioUno}" />
								
							</h:panelGrid>
						
							<h:panelGrid columns="2" style="width:100%;" frame="box" columnClasses="label-bold, alinearDerecha">
								<h:outputLabel value="INGRESOS" />
								<h:outputText value="#{presupuestoController.informePresupuesto.puntoEquilibrio.verifIngresos}" converter="org.espe.sigec.numberConverter"/>
								
								<h:outputLabel value="COSTOS VARIABLES" />
								<h:outputText value="#{presupuestoController.informePresupuesto.puntoEquilibrio.verifCostoVariable}" converter="org.espe.sigec.numberConverter"/>
								
								<h:outputLabel value="COSTOS FIJOS" />
								<h:outputText value="#{presupuestoController.informePresupuesto.puntoEquilibrio.verifCostoFijo}" converter="org.espe.sigec.numberConverter"/>
								
								<h:outputLabel value="UTILIDAD" />
								<h:outputText value="#{presupuestoController.informePresupuesto.puntoEquilibrio.verifUtilidad}" converter="org.espe.sigec.numberConverter"/>
							</h:panelGrid>
						</h:panelGrid>
					</h:panelGrid>
				</h:panelGroup>
			</rich:collapsiblePanel>
		</rich:panel>
	</h:form>
</ui:composition>