<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
    xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:sigecComp="http://java.sun.com/jsf/composite/components">
	
    	<h:outputStylesheet library="css" name="textos.css"/>    
    	<h:outputStylesheet library="css" name="bordes.css"/>
    	<h:outputStylesheet library="css" name="botones.css"/>
    	<h:outputStylesheet library="css" name="tables.css"/>
    	
        <h:form id="frmRepCurso">
        	<rich:panel header="#{msg['cursos_disponibles']}">
        	
	        	<fieldset>
	        		<legend>
	        			<h:outputLabel value="#{msg['cursos_disponibles']}" styleClass="titulo"/>
	        		</legend>
	        		
	        		<a4j:outputPanel ajaxRendered="true">
	        		
		        		<rich:dataTable id="tblCursos" style="width:100%" value="#{reporteCursoController.lstCursos}" var="curso" rows="10" 
		        			rendered="#{!empty reporteCursoController.lstCursos}" rowClasses="even-row, odd-row">
		        			<f:facet name="header">
		        				<h:outputLabel value="Cursos" />
		        			</f:facet>
		        			
		        			<rich:column>
		        				<a4j:commandLink rendered="#{!curso.showCursoPeriodoCollection}" action="#{reporteCursoController.btnExpandContractCurso(curso, true)}" render="tblCursos">
		        					<h:graphicImage library="images/button" name="expand.png"/>
		        				</a4j:commandLink>
		        				
		        				<a4j:commandLink rendered="#{curso.showCursoPeriodoCollection}" action="#{reporteCursoController.btnExpandContractCurso(curso, false)}" render="tblCursos">
		        					<h:graphicImage library="images/button" name="contract.png"/>
		        				</a4j:commandLink>
		        			</rich:column>
		        			
		        			<rich:column style="text-align:center;" filterValue="#{reporteCursoController.nameEspecialidadFilter}"
		                				filterExpression="#{fn:containsIgnoreCase(curso.especialidad.nombre, reporteCursoController.nameEspecialidadFilter)}">
			        			<f:facet name="header">
			        				<h:panelGrid columns="2" style="width:100%">
			        					<h:outputLabel value="#{msg['etiqueta_especialidad']}" />
			        					<h:selectOneMenu value="#{reporteCursoController.nameEspecialidadFilter}">
					                    	<f:selectItems value="#{reporteCursoController.itemsEspecialidadesFiltro}"/>
					                        <a4j:ajax render="tblCursos" execute="@this" event="change" />
				                        </h:selectOneMenu>
			        				</h:panelGrid>
			        				
			        			</f:facet>
			        			<h:outputText value="#{curso.especialidad.nombre}" />
		        			</rich:column>
		        			
		        			<rich:column filterValue="#{reporteCursoController.nameFilter}"
                				filterExpression="#{fn:containsIgnoreCase(curso.nombreCurso,reporteCursoController.nameFilter)}"
                				sortBy="#{curso.nombreCurso}" sortOrder="#{reporteCursoController.namesOrder}">
			        			<f:facet name="header">
			        				<h:panelGrid columns="2" style="width:100%;">
					        			
				        				<h:panelGrid columns="2" style="width:100%;">
		        							<h:outputLabel value="#{msg['nombre']}" />
		        							
		        							<h:inputText value="#{reporteCursoController.nameFilter}" onkeypress="if (event.keyCode == 13) return false;" styleClass="text-uppercase" style="width:100%;">
					                            <a4j:ajax event="keyup" render="tblCursos@body" execute="@this" onbeforesubmit="if (event.keyCode != 13)  return false;" limitRender="true"/>
					                        </h:inputText>
		        						</h:panelGrid>
		        						
		        						<h:panelGroup layout="block" style="float:right">
		        							 <a4j:commandLink render="table" action="#{reporteCursoController.sortByNames}" >
		        							 	<h:graphicImage library="images/button" name="sortArrow.png" height="12"/>
		        							 </a4j:commandLink>
		        						</h:panelGroup>
	        						</h:panelGrid>	
			        			</f:facet>
			        			<a4j:commandLink value="#{curso.nombreCurso}" action="#{reporteCursoController.btnShowCursoDetail(curso)}"></a4j:commandLink>
		        			</rich:column>
		        			
		        			<rich:column>
			        			<f:facet name="header">
			        				<h:outputLabel value="#{msg['descripcion']}" />
			        			</f:facet>
			        			<h:outputText value="#{curso.generalidadesCurso}" />
		        			</rich:column>
		        			
		        			<rich:column breakRowBefore="true" colspan="4" rendered="#{curso.showCursoPeriodoCollection}">
			        			<center>
			        			<rich:panel rendered="#{empty curso.moduloCursoCollection}">
			        				<h:outputLabel value="#{msg.curso_sin_modulos_relacionados}" style="color:red;"/> 
			        			</rich:panel>
			        			<rich:dataTable value="#{curso.moduloCursoCollection}" var="modulo" rendered="#{!empty curso.moduloCursoCollection}" style="width:90%;">
			        				<f:facet name="header">
		        						<h:outputLabel value="#{msg.etiqueta_modulos_curso}" />
		        					</f:facet>
			        				
			        				<rich:column>
				        				<a4j:commandLink rendered="#{!modulo.showPensum}" action="#{reporteCursoController.btnExpandContractModulo(modulo, true)}" render="tblCursos">
				        					<h:graphicImage library="images/button" name="expand.png"/>
				        				</a4j:commandLink>
				        				
				        				<a4j:commandLink rendered="#{modulo.showPensum}" action="#{reporteCursoController.btnExpandContractModulo(modulo, false)}" render="tblCursos">
				        					<h:graphicImage library="images/button" name="contract.png"/>
				        				</a4j:commandLink>
				        			</rich:column>
				        			
			        				<rich:column>
			        					<f:facet name="header">
			        						<h:outputLabel value="#{msg['nombre']}" />
			        					</f:facet>
			        					<h:outputText value="#{modulo.nombre}" />
			        				</rich:column>
			        				
			        				<rich:column>
			        					<f:facet name="header">
			        						<h:outputLabel value="#{msg['descripcion']}" />
			        					</f:facet>
			        					<h:outputText value="#{modulo.generalidades}" />
			        				</rich:column>
			        				
			        				<rich:column breakRowBefore="true" colspan="4" rendered="#{modulo.showPensum}">
			        					<center>
			        					<rich:dataTable value="#{modulo.pensumAcademicoCollection}" var="pensumCurso" style="width:90%;">
			        						<f:facet name="header">
						        				<h:outputLabel value="#{msg.etiqueta_tema}" />
						        			</f:facet>
			        						<rich:column>
			        							<f:facet name="header">
			        								<h:outputLabel value="Nombre" />
			        							</f:facet>
			        							<h:outputText value="#{pensumCurso.tema}" />
			        						</rich:column>
			        						
			        						<rich:column>
			        							<f:facet name="header">
			        								<h:outputLabel value="#{msg['descripcion']}" />
			        							</f:facet>
			        							<h:outputText value="#{pensumCurso.descripcion}" />
			        						</rich:column>
			        					</rich:dataTable>
			        					</center>
			        				</rich:column>
			        			</rich:dataTable>
			        			</center>
		        			</rich:column>
		        		</rich:dataTable>
		        		<center>
		        			<rich:dataScroller for="tblCursos" renderIfSinglePage="false" fastControls="hide"/>
		        		</center>
	        		</a4j:outputPanel>
	        	</fieldset>	
        	</rich:panel>
        	
        </h:form>
        
</ui:composition>